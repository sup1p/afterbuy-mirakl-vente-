# Модуль src/routers

Этот модуль определяет обработчики маршрутов API для сервиса XXLmebel 1. Каждый роутер отвечает за определенный набор эндпоинтов и бизнес-логику.

# vente

## - mirakl_system_vente_router.py
Обрабатывает статус платформы Mirakl, отчеты об ошибках и эндпоинты конфигурации системы.
- **Эндпоинты:**
  - `/import-product-error/{import_parameter}`: Возвращает отчеты об ошибках импорта продуктов в Mirakl.
  - `/mirakl-platform-settings`: Возвращает текущие настройки платформы Mirakl.
  - `/mirakl-product-non-integrated/{import_parameter}`: Проверяет продукты, не интегрированные в Mirakl.
- **Пример функции:**
  ```python
  @router.get("/mirakl-platform-settings")
  async def get_mirakl_settings(...):
      # Возвращает настройки платформы Mirakl в виде словаря
  ```
- **Ответственности:**
  - Агрегирует информацию об ошибках и статусе из Mirakl.
  - Предоставляет конфигурацию системы для проверки состояния интеграции.

## - product_vente_router.py
Управляет эндпоинтами импорта продуктов из Afterbuy в Mirakl.
- **Эндпоинты:**
  - `/import-product/vente/{ean}`: Импортирует один продукт по EAN.
  - `/import-products/vente`: Импортирует несколько продуктов по списку EAN.
  - `/import-products-by-fabric/{afterbuy_fabric_id}`: Импортирует продукты по ID ткани Afterbuy и дням доставки (с опциями).
- **Пример функции:**
  ```python
  @router.post("/import-product/vente/{ean}")
  async def import_product(ean: int, ...):
      # Получает продукт из Afterbuy, сопоставляет атрибуты, генерирует CSV, импортирует в Mirakl
  ```
- **Ответственности:**
  - Получает данные о продуктах из Afterbuy.
  - Сопоставляет и нормализует атрибуты продуктов для Mirakl.
  - Генерирует CSV и инициирует импорт в Mirakl.
  - Обрабатывает пакетный импорт и отчеты об ошибках.

## - product_vente_from_file.py
Обрабатывает импорт продуктов из Afterbuy в Mirakl с использованием данных из файлов.
- **Эндпоинты:**
  - `/import-products-by-fabric-from-file/vente`: Импортирует продукты по ID ткани из файла.
- **Пример функции:**
  ```python
  @router.post("/import-products-by-fabric-from-file/vente")
  async def import_products_by_fabric(...):
      # Импортирует продукты по ID ткани Afterbuy из файла в Mirakl
  ```
- **Ответственности:**
  - Загружает данные продуктов из файла.
  - Сопоставляет атрибуты и нормализует данные.
  - Генерирует CSV и инициирует импорт в Mirakl.

## - dev_vente_router.py
Предоставляет эндпоинты для разработки и отладки сопоставления продуктов и обработки изображений.
- **Эндпоинты:**
  - `/test-import-product/vente/{ean}`: Возвращает сопоставленные данные для одного продукта (без импорта).
  - `/test-import-products-by-fabric/vente/{afterbuy_fabric_id}`: Возвращает сопоставленные данные для всех продуктов в ткани (без импорта).
  - `/test-resize-image`: Тестирует изменение размера изображения и загрузку на FTP.
  - `/test-remove-bg-image`: Тестирует удаление фона изображения и возвращает очищенное изображение.
- **Пример функции:**
  ```python
  @router.post("/test-resize-image")
  async def test_resize_image(data: TestImageResize, ...):
      # Изменяет размер изображения и загружает на FTP для тестирования
  ```
- **Ответственности:**
  - Позволяет разработчикам проверять логику сопоставления и обработки изображений.
  - Полезен для устранения проблем интеграции перед импортом в продакшн.

# lutz