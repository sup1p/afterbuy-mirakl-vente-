# Модуль src (Корень)

Эта директория содержит точку входа основного приложения, общие ресурсы и схемы данных. Каждый файл важен для запуска приложения, управления ресурсами и валидации данных.

## main.py
Точка входа приложения FastAPI.
- **Жизненный цикл приложения:** Управляет событиями запуска и завершения, включая инициализацию HTTP-клиента.
- **Регистрация маршрутов:** Включает все маршруты API для продуктов, системы Mirakl и тестовых эндпоинтов.
- **Проверка состояния:** Реализует корневой эндпоинт (`/`) для проверки статуса сервиса.
- **Пример:**
  ```python
  @app.get("/")
  def root():
      return {"status": "ok"}
  ```

## resources.py

Модуль для управления глобальными общими ресурсами, используемыми в приложении.  
Обеспечивает централизованную инициализацию и доступ к HTTP-клиентам и объектам, связанным с LLM.

- **Управление глобальными ресурсами:**  
  Центральное место для создания и повторного использования общих объектов вместо их создания для каждого запроса.  

- **Общие ресурсы:**  
  - `client`: Глобальный `httpx.AsyncClient` для выполнения внешних API-запросов (повторно используется для избежания накладных расходов).  
  - `openai_client`: Глобальный экземпляр `AsyncOpenAI`, инициализируется при запуске приложения.  
  - `llm_agent`: `pydantic_ai.Agent` для обработки запросов к LLM.  
  - `llm_semaphore`: `asyncio.Semaphore` для управления параллельностью одновременных вызовов к LLM.  

- **Использование:**  
  Импортируйте ресурсы там, где это необходимо, и обеспечьте их правильную инициализацию/очистку во время запуска/завершения приложения.

## models.py

Содержит SQLAlchemy модели для базы данных.

- **User:**
  - Хранит данные о пользователях, включая имя, хэшированный пароль и статус администратора.
  - Связь с загруженными тканями и EAN-кодами.

- **UploadedFabric:**
  - Хранит данные о загруженных тканях, включая идентификатор, статус и связь с пользователем.
  - Поля: `afterbuy_fabric_id`, `market`, `shop`, `status`, `user_id`, `date_time`.

- **UploadedEan:**
  - Хранит данные о загруженных EAN-кодах, включая идентификатор, связь с тканью и пользователем.
